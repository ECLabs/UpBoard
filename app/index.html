<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>small_byte</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
		<script src="scripts/modernizr.custom.js"></script>
        <!-- Font -->
        <link href='http://fonts.googleapis.com/css?family=Slabo+27px' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz' rel='stylesheet' type='text/css'>

        <link rel="stylesheet" href="styles/main.css">
        <link rel="icon" type="image/ico" href="images/icon.png">

    </head>
    <body>
        <div class="container">
            <!--logo -->
            <div>
                <div class="movingBackground hidden"></div>
                <img class="logo hidden"></img>
            </div>

            <!--picture -->
            <div class="picture hidden">
                <center><p></p></center>
                <img class="fullscreen"></img>
            </div>

            <!--staticVideoOverlay-->
            <div class="missionStatement hidden">
              <video></video>
              <div class="box">
                  <p>
                      <!--liveVideoOverlayContent Injected Here -->
                  </p>
                  <div class="boxBottomLeft"></div>
                  <img id="star"></img>
                  <div class="boxBottomRight"></div>                
              </div>
           </div>

            <!--news-->
            <div class="news hidden">
                <div class="centerBox">
                  <div class="newsSection twitter" >
                    <div class="innerTop leftSide" >
                      <img src="images/twitterlogo.png" class="logoImg"/>
                    </div>
                    <div class="innerBottom leftSide">
                      <p class="washingtonPostArticleTitle"></p>
                      <p class="washingtonPostArticleContent"></p>
                      <p class="washingtonPostArticleAuthor"></p>
                      <p class="washingtonPostArticleDate"></p>
                    </div>
                  </div>
                  <div class="newsSection instagram">
                    <div class="innerTop">
                      <img src="images/instagram3.png" class="logoImg"/>
                    </div>
                    <div class="innerBottom">
                      <p class="washingtonPostArticleTitle">
                        This slide will include three items: a tweet, an instagram image, and a news article. For this story, focus only on the news article. See the attached wireframe for guidance.
                      </p>
                      <p class="washingtonPostArticleContent">
                        This slide will include three items: a tweet, an instagram image, and a news article. For this story, focus only on the news article. See the attached wireframe for guidance.
                      </p>
                      <p class="washingtonPostArticleAuthor">
                        Kole Myers
                      </p>
                      <p class="washingtonPostArticleDate">
                        6/6/23
                      </p>
                    </div>
                  </div>
                  <div class="newsSection washingtonPost">
                    <div class="innerTop">
                      <img src="images/Washington-post-logo-thumb.png" class="logoImg"/>
                    </div>
                    <div class="innerBottom">
                      <p class="washingtonPostArticleTitle">
                        This slide will include three items: a tweet, an instagram image, and a news article. For this story, focus only on the news article. See the attached wireframe for guidance.
                      </p>
                      <p class="washingtonPostArticleContent">
                        This slide will include three items: a tweet, an instagram image, and a news article. For this story, focus only on the news article. See the attached wireframe for guidance.
                      </p>
                      <p class="washingtonPostArticleAuthor">
                        Kole Myers
                      </p>
                      <p class="washingtonPostArticleDate">
                        6/6/23
                      </p>
                    </div>
                  </div>
                </div>
            </div>

            <div>
                <!--webcam background-->
                <video  autoplay="true" class="hidden" id="videoElement"></video>

                <!--weather -->
                <div class="weather hidden">
                    <p>
                        <!--weather information Injected Here -->
                    </p>
                </div>
            </div>

            <!--bioPanels -->
            <div id="bl-main" class="bl-main hidden">

                <section id="section1">
                    <div class="bl-box">
                        <h2 class="bl-icon bl-icon-about"><!--bioPanels top left first name Injected Here --></h2>
                    </div>
                    <div class="bl-content">
                        <h2><!--bioPanels top left name Injected Here --></h2>
                        <p><!--bioPanels top left text Injected Here --></p>
                    </div>
                </section>

                <section id="section2">
                    <div class="bl-box">
                        <h2 class="bl-icon bl-icon-works"><!--bioPanels top right first name Injected Here --></h2>
                    </div>
                    <div class="bl-content">
                        <h2><!--bioPanels top right name Injected Here --></h2>
                        <p><!--bioPanels top right text Injected Here --></p>
                    </div>
                </section>

                <section id="section3">
                    <div class="bl-box">
                        <h2 class="bl-icon bl-icon-blog"><!--bioPanels botto left first name Injected Here --></h2>
                    </div>
                    <div class="bl-content">
                        <h2><!--bioPanels bottom left name Injected Here --></h2>
                        <p><!--bioPanels bottom left text Injected Here --></p>
                    </div>
                </section>

                <section id="section4">
                    <div class="bl-box">
                        <h2 class="bl-icon bl-icon-contact"><!--bioPanels bottom right first name Injected Here --></h2>
                    </div>
                    <div class="bl-content">
                        <h2><!--bioPanels bottom right name Injected Here --></h2>
                        <p><!--bioPanels bottom right text Injected Here --></p>
                    </div>
                </section>

                <section id="section5">
                    <div class="bl-box">
                        <h2 class="bl-icon bl-icon-contact"><!--bioPanels bottom right first name Injected Here --></h2>
                    </div>
                    <div class="bl-content">
                        <h2><!--bioPanels bottom right name Injected Here --></h2>
                        <p><!--bioPanels bottom right text Injected Here --></p>
                    </div>
                </section>

                <section id="section6">
                    <div class="bl-box">
                        <h2 class="bl-icon bl-icon-contact"><!--bioPanels bottom right first name Injected Here --></h2>
                    </div>
                    <div class="bl-content">
                        <h2><!--bioPanels bottom right name Injected Here --></h2>
                        <p><!--bioPanels bottom right text Injected Here --></p>
                    </div>
                </section>

            </div>

        </div>

        <script src="../bower_components/jquery/dist/jquery.js"></script>
        <script src="https://cdn.firebase.com/js/client/2.2.4/firebase.js"></script>
        <script type="text/javascript">
            var firebaseRef = new Firebase("https://boiling-heat-9947.firebaseio.com/");
        </script>
        <!-- <script src="scripts/news.js"></script> -->
        <script src="scripts/bioPanels.js"></script>
        <script src="scripts/liveVideoOverlay.js"></script>
        <script src="scripts/staticVideoOverlay.js"></script>
        <script src="scripts/logo.js"></script>
        <script src="scripts/picture.js"></script>
        <script src="scripts/weather.js"></script>

        </script>
        <script>
            $(function() {

                //set up webcam feed
                (function() {

                    var video = document.querySelector("#videoElement");

                    navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia || navigator.oGetUserMedia;

                    if (navigator.getUserMedia) {
                        navigator.getUserMedia({video: true, audio: true}, handleVideo, videoError);
                    }

                    function handleVideo(stream) {

                        video.src = window.URL.createObjectURL(stream);
                        video.volume = 0;

                    }

                    function videoError(e) {
                        console.log('error, no webcam support found');
                    }

                })();

                //Get and set washingtonPost content
                var washingtonPostData;
                $.ajax({
                 url      : document.location.protocol + '//ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=10&callback=?&q=' + encodeURIComponent('http://feeds.washingtonpost.com/rss/blogs/rss_the-switch'),
                  dataType : 'json',
                  success  : function (data) {
                    console.log(data);
                    washingtonPostData = data;
                    var current = data.responseData.feed.entries[0];
                    $('.washingtonPostArticleTitle').html(current.title);
                    $('.washingtonPostArticleContent').html(current.contentSnippet);
                    $('.washingtonPostArticleAuthor').html(current.author);
                    console.log(current.publishedDate);
                    var res = current.publishedDate.slice(5,25);

                    //September abbreviation is Sept so it adds another character and requires special parsing
                    if (res.slice(3,6) === 'Sep') {
                      var month = 9;
                      var day = res.slice(0,2);
                      var year = res.slice(8,12);
                      var dayTime = res.slice(13,21);
                    }
                    console.log(res);
                    var day = res.slice(0,2);
                    console.log(day);
                    var month = res.slice(3,6);
                    console.log(month);
                    var year = res.slice(7,11);
                    console.log(year);
                    var dayTime = res.slice(12,20);
                    console.log(dayTime);

                  },
                  error : function(data){
                    console.log(data)
                  }
                });
                //get firebase info
                firebaseRef.once('value', function(snapshot) {

                    //use this function if you want to write firebase data easily. Note to add a slide copy object of type you wish to add and place in the order you want. make sure that order is ascending by number
                    /*
                    (function(){
                        firebaseRef.set({
                              1: {
                                    type: "logo",
                                    transitions: {
                                        entry: 'fade',
                                        exit: 'fade'
                                    },
                                    timing: {
                                        slideTime:5000 ,
                                        transitionTime: 2000,
                                    }
                              },
                              2: {
                                  type: "liveVideoOverlay",
                                  transitions: {
                                      entry: 'fade',
                                      exit: 'fade'
                                  },
                                  timing: {
                                      slideTime: 5000,
                                      transitionTime: 2000,
                                      audioFadeTime: 2000,
                                  },
                                  content: {
                                      overlay: 'Customer-driven software <br/> development for government <br/> and commercial enterprises.',
                                      overlayColor: '#FAFCFA',
                                  }
                              },
                              3: {
                                  type: "bioPanels",
                                  transitions: {
                                      entry: 'fade',
                                      exit: 'fade'
                                  },
                                  timing: {
                                      openFirstSection: 3000,
                                      openSection: 1000,
                                      sectionTime: 5000,
                                      transitionTime:1000,
                                  },
                                  content: {
                                      content: [{"name":"Jamil Evans","bio":"As President of Evans & Chambers Technology, Jamil Evans is charged with maintaining good relationships with stakeholders in the Federal Government and Intelligence Community. He manages the technical director of the company to ensure that EC's core competencies and innovations are aligned with our customer base. Jamil's uncommon mixture of hard-core technical expertise and strategic relationship management skills drive the company's winning results. Jamil is an expert in service oriented architectures (SOA), secure web service standards definition, and the design and implementation of mission-critical enterprise services and systems. Prior to founding Evans & Chambers Technology, Jamil served as a senior software engineer at Booz Allen Hamilton, providing vendor analysis and software development services to an Intelligence Community customer."},{"name":"Mary Sabatino","bio":"As a Program Manager for Evans & Chambers Technology, Mary Sabatino plays a key role in transforming customer requirements into application design and managing the resources needed to complete projects. She also works closely with development teams to keep the project within scope and to meet production and budget targets. She supports the entire Software Development Life Cycle, including requirements definition, functional design, development, system testing, documentation, training, implementation, maintenance, and customer support. Prior to working with EC, Mary managed projects with L-3 Communications and CACI to support complex information technology projects.  Mary finds it very rewarding to watch a design “come to life” in the form of a working application and her customers praise her dedication, thoroughness, and ability to go above and beyond to ensure that her projects are managed and executed efficiently."},{"name":"Ryan Gross","bio":"Ryan Gross joined Evans & Chambers Technology (EC) in November 2013. Before joining the team, he worked on a commercial project for EC, developing a workflow management tool built on Java using the Grails framework and utilizing a MySQL database. His previous experience in Java development and web development prepared him for his new role at EC as a Software Developer / Engineer I. Ryan enjoys the challenge of developing and enjoys the opportunity to work on projects that provide a positive impact."},{"name":"Vik David","bio":"Vik David is a Software Engineer for Evans & Chambers Technology's and has been working with EC since September 2010. Vik takes a lot of satisfaction in creating something that will help his clients in their jobs. His focus is on front-end technologies and he recently re-wrote and improved a widely-used dashboard report for his client."}],
                                  }
                              },
                              4: {
                                  type: "weather",
                                  transitions: {
                                      entry: 'fade',
                                      exit: 'fade'
                                  },
                                  timing: {
                                      slideTime: 10000,
                                      transitionTime: 2000,
                                  },
                                  content: {
                                      overlayColor: '#FAFCFA',
                                      zip: '20001'
                                  }
                              },
                              5: {
                                  type: "picture",
                                  transitions: {
                                      entry: 'fade',
                                      exit: 'fade'
                                  },
                                  timing: {
                                      slideTime: 10000,
                                      transitionTime: 2000,
                                  },
                                  content: {
                                      caption: "Photo caption goes here"
                                  },
                              }
                            });
                    })(); */

                    //holder array to specify slide order
                    var slideOrder = [];
                    //calculate total slideshow time
                    var totalTime = function() {
                        var time=2000;
                        snapshot.forEach(function(childSnapshot) {

                            var key = childSnapshot.val();
                            slideOrder.push(key.type); //fill in order array

                            if(key.type ==='logo' || key.type==='liveVideoOverlay' || key.type==='picture' || key.type==='staticVideoOverlay'){
                              time+= (key.timing.slideTime + key.timing.transitionTime);
                            } else if (key.type==='bioPanels'){
                              time+= (key.timing.openFirstSection + (key.timing.openSection*6) + (key.timing.sectionTime*6) + key.timing.transitionTime);
                          } else if(key.type==='weather'){ //if type is weather then add time same as others and get weather info from api
                              time+= (key.timing.slideTime + key.timing.transitionTime);
                              $.ajax({
                                 url: 'http://api.openweathermap.org/data/2.5/weather?zip='+ key.content.zip + ',us&units=imperial&APPID=8cbe87b8668498c44b0ade0ce19afd6b',
                                 data: {
                                    format: 'json'
                                 },
                                 error: function() {
                                    console.error("something went wrong with ajax call")
                                 },
                                 dataType: 'jsonp',
                                 success: function(data) {
                                    $('.weather p').html("<div>" + data.name + "</div>" + data.main.temp + "º | " +toCamelCase(data.weather[0].description));
                                 },
                                 type: 'GET'
                             });

                          }

                        });
                      return time;
                    };

                    // start interval
                    (function(){
                        setInterval(function(){                          
                            window[slideOrder[0]](snapshot.val(), slideOrder, 0);
                        }, totalTime());
                    })();

                    window[slideOrder[0]](snapshot.val(), slideOrder, 0); //pass slide1 the firebase data & array
                    
                    //Pre-load picture so it is rendered to screen in time
                    for(i in snapshot.val()){
                      if(snapshot.val()[i] != undefined){
                        if(snapshot.val()[i].type == "picture"){
                          $('.picture img').attr('src', snapshot.val()[i].content.imageUrl);
                          break;
                        }
                      }
                    }

                }, function (err) { // throw error if get request fails
                    console.error(err);
                }

                );

            });
        </script>
</body>
</html>
